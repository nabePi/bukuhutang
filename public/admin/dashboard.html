<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BukuHutang Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600;700&family=Fira+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* UI/UX Pro Max Design System - Dark Mode OLED */
            --bg-primary: #020617;
            --bg-secondary: #0F172A;
            --bg-card: #1E293B;
            --bg-hover: #334155;
            
            --text-primary: #F8FAFC;
            --text-secondary: #94A3B8;
            --text-muted: #64748B;
            
            --accent-primary: #22C55E;
            --accent-primary-glow: rgba(34, 197, 94, 0.3);
            --accent-warning: #F59E0B;
            --accent-error: #EF4444;
            --accent-info: #3B82F6;
            
            --border: rgba(148, 163, 184, 0.1);
            --border-focus: rgba(34, 197, 94, 0.5);
            
            /* Typography */
            --font-sans: 'Fira Sans', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            --font-mono: 'Fira Code', 'Consolas', 'Monaco', monospace;
        }

        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box;
        }

        html {
            max-width: 100vw;
            overflow-x: hidden;
        }

        body {
            font-family: var(--font-sans);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Layout */
        .app {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            padding: 32px 24px;
            border-bottom: 1px solid var(--border);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .brand-icon {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--accent-primary), #16A34A);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 0 20px var(--accent-primary-glow);
        }

        .brand-text h1 {
            font-family: var(--font-mono);
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .brand-text p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            font-family: var(--font-mono);
        }

        .nav {
            padding: 16px 12px;
            flex: 1;
        }

        .nav-section {
            margin-bottom: 24px;
        }

        .nav-label {
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
            padding: 0 12px;
            margin-bottom: 8px;
            font-family: var(--font-mono);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 200ms ease;
            color: var(--text-secondary);
            margin-bottom: 4px;
            border: none;
            background: transparent;
            width: 100%;
            font-size: 0.9375rem;
            font-family: inherit;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: rgba(34, 197, 94, 0.15);
            color: var(--accent-primary);
            box-shadow: inset 0 0 0 1px rgba(34, 197, 94, 0.3);
        }

        .nav-item svg {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        /* Main Content */
        .main {
            flex: 1;
            margin-left: 280px;
            padding: 32px;
            min-height: 100vh;
            max-width: 100%;
            overflow-x: hidden;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 32px;
        }

        .header-title h2 {
            font-family: var(--font-mono);
            font-size: 1.875rem;
            font-weight: 700;
            margin-bottom: 4px;
            letter-spacing: -0.5px;
        }

        .header-title p {
            color: var(--text-secondary);
            font-size: 0.9375rem;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 0.9375rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 200ms ease;
            border: none;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: var(--bg-primary);
            box-shadow: 0 0 20px var(--accent-primary-glow);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 0 30px var(--accent-primary-glow);
        }

        .btn-secondary {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            border-color: var(--border-focus);
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border-radius: 16px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: all 200ms ease;
        }

        .card:hover {
            border-color: var(--border-focus);
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.1);
        }

        .card-header {
            padding: 24px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-family: var(--font-mono);
            font-size: 1.125rem;
            font-weight: 600;
        }

        .card-body {
            padding: 24px;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 24px;
            margin-bottom: 32px;
        }

        @media (max-width: 1280px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: 1fr; }
        }

        .stat-card {
            background: var(--bg-secondary);
            border-radius: 16px;
            padding: 24px;
            border: 1px solid var(--border);
            transition: all 200ms ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), transparent);
            opacity: 0;
            transition: opacity 200ms ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            border-color: var(--border-focus);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            background: var(--bg-card);
        }

        .stat-icon.green {
            background: rgba(34, 197, 94, 0.15);
            box-shadow: 0 0 20px var(--accent-primary-glow);
        }

        .stat-badge {
            font-family: var(--font-mono);
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .stat-badge.active {
            background: rgba(34, 197, 94, 0.15);
            color: var(--accent-primary);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 8px;
        }

        .stat-value {
            font-family: var(--font-mono);
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        /* WhatsApp Status */
        .wa-status {
            display: flex;
            align-items: center;
            gap: 24px;
            flex-wrap: wrap;
        }

        .wa-info {
            flex: 1;
            min-width: 200px;
        }

        .wa-status-main {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .wa-status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .wa-status-dot.connected {
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary);
        }

        .wa-status-dot.disconnected {
            background: var(--accent-error);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .wa-phone {
            font-family: var(--font-mono);
            color: var(--text-secondary);
            font-size: 0.9375rem;
        }

        .wa-actions {
            display: flex;
            gap: 12px;
        }

        @media (max-width: 640px) {
            .wa-actions {
                width: 100%;
            }
            
            .wa-actions .btn {
                flex: 1;
                min-width: 140px;
            }
        }
        
        @media (max-width: 480px) {
            .wa-actions .btn {
                width: 100%;
            }
        }

        /* QR Section */
        .qr-section {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border);
            text-align: center;
        }

        .qr-image {
            max-width: 200px;
            border-radius: 12px;
            margin-bottom: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .qr-timer {
            font-family: var(--font-mono);
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-error);
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
            margin-bottom: 8px;
        }

        .qr-hint {
            color: var(--text-secondary);
            font-size: 0.9375rem;
        }

        /* Tables */
        .table-container {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table-container::-webkit-scrollbar {
            height: 6px;
        }

        .table-container::-webkit-scrollbar-track {
            background: var(--bg-card);
            border-radius: 3px;
        }

        .table-container::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            font-family: var(--font-mono);
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-muted);
        }

        tr:hover td {
            background: rgba(34, 197, 94, 0.05);
        }

        /* Status Badges */
        .status {
            font-family: var(--font-mono);
            font-size: 0.6875rem;
            font-weight: 600;
            text-transform: uppercase;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .status.active {
            background: rgba(34, 197, 94, 0.15);
            color: var(--accent-primary);
        }

        .status.pending {
            background: rgba(245, 158, 11, 0.15);
            color: var(--accent-warning);
        }

        .status.paid {
            background: rgba(59, 130, 246, 0.15);
            color: var(--accent-info);
        }

        .status.overdue {
            background: rgba(239, 68, 68, 0.15);
            color: var(--accent-error);
        }

        /* Progress Bars */
        .progress-container {
            margin-top: 12px;
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-card);
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 300ms ease;
        }

        .progress-fill.green {
            background: var(--accent-primary);
            box-shadow: 0 0 10px var(--accent-primary-glow);
        }

        .progress-fill.yellow {
            background: var(--accent-warning);
        }

        .progress-fill.red {
            background: var(--accent-error);
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-top: 6px;
            font-family: var(--font-mono);
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(2, 6, 23, 0.8);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 24px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border-radius: 16px;
            max-width: 400px;
            width: 100%;
            padding: 24px;
            border: 1px solid var(--border);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        .modal-title {
            font-family: var(--font-mono);
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .modal-message {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 48px 24px;
            color: var(--text-secondary);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.3;
        }

        /* Page Content */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 100%;
                height: auto;
                position: fixed;
                bottom: 0;
                top: auto;
                border-right: none;
                border-top: 1px solid var(--border);
                z-index: 100;
            }

            .sidebar-header {
                display: none;
            }

            .nav {
                display: flex;
                padding: 6px 4px;
                gap: 2px;
                overflow-x: auto;
                scrollbar-width: none;
                justify-content: space-around;
            }

            .nav::-webkit-scrollbar {
                display: none;
            }

            .nav-section {
                display: contents;
            }

            .nav-label {
                display: none;
            }

            .nav-item {
                flex-direction: column;
                padding: 6px 8px;
                font-size: 0.6rem;
                min-width: 52px;
                max-width: 60px;
                gap: 2px;
                flex-shrink: 0;
            }

            .nav-item svg {
                width: 20px;
                height: 20px;
            }

            .main {
                margin-left: 0;
                margin-bottom: 80px;
                padding: 16px;
                max-width: 100vw;
                overflow-x: hidden;
            }

            .header {
                flex-direction: column;
                gap: 16px;
            }

            .header-title h2 {
                font-size: 1.5rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .stat-card {
                padding: 16px;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .card {
                max-width: 100%;
            }

            .card-header {
                flex-direction: column;
                gap: 12px;
                align-items: flex-start;
                padding: 16px;
            }

            .card-body {
                padding: 16px;
            }

            .wa-status {
                flex-direction: column;
                align-items: flex-start;
            }

            .wa-actions {
                width: 100%;
            }

            .wa-actions .btn {
                width: 100%;
            }

            .table-container {
                margin: 0 -16px;
                padding: 0 16px;
                width: calc(100% + 32px);
            }

            th, td {
                padding: 12px 8px;
                font-size: 0.875rem;
                white-space: nowrap;
            }

            th:first-child,
            td:first-child {
                position: sticky;
                left: 0;
                background: var(--bg-secondary);
                z-index: 1;
            }
        }

        @media (max-width: 480px) {
            .main {
                padding: 16px;
            }

            .header-title h2 {
                font-size: 1.5rem;
            }

            .stat-value {
                font-size: 1.5rem;
            }

            .wa-status {
                flex-direction: column;
                align-items: flex-start;
            }

            .wa-actions {
                width: 100%;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* Reduced Motion */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body>
    <!-- Modal -->
    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-title" id="modalTitle">üì¢ Pemberitahuan</div>
            <div class="modal-message" id="modalMessage">Message</div>
            <div class="modal-actions" id="modalActions">
                <button class="btn btn-primary" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>

    <div class="app">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <a href="#" class="brand">
                    <div class="brand-icon">üí∞</div>
                    <div class="brand-text">
                        <h1>BukuHutang</h1>
                        <p>Admin Dashboard</p>
                    </div>
                </a>
            </div>
            <nav class="nav">
                <div class="nav-section">
                    <div class="nav-label">Menu</div>
                    <button class="nav-item active" onclick="showPage('overview')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                        <span>Overview</span>
                    </button>
                    <button class="nav-item" onclick="showPage('borrowers')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                        <span>Borrowers</span>
                    </button>
                    <button class="nav-item" onclick="showPage('lenders')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        <span>Lenders</span>
                    </button>
                    <button class="nav-item" onclick="showPage('agreements')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <span>Perjanjian</span>
                    </button>
                    <button class="nav-item" onclick="showPage('installments')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        <span>Cicilan</span>
                    </button>
                    <button class="nav-item" onclick="showPage('system')">
                        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2m-2-4h.01M17 16h.01"></path></svg>
                        <span>System</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main">
            <!-- Overview Page -->
            <div id="page-overview" class="page active">
                <header class="header">
                    <div class="header-title">
                        <h2>Dashboard Overview</h2>
                        <p>Ringkasan aktivitas BukuHutang</p>
                    </div>
                    <button class="btn btn-secondary" onclick="refreshAll()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                        Refresh
                    </button>
                </header>

                <!-- WhatsApp Card -->
                <div class="card" style="margin-bottom: 32px;">
                    <div class="card-header">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 1.5rem;">üì±</span>
                            <span class="card-title">WhatsApp Connection</span>
                        </div>
                        <span id="waBadge" class="stat-badge">Checking...</span>
                    </div>
                    <div class="card-body">
                        <div class="wa-status">
                            <div class="wa-info">
                                <div class="wa-status-main" id="waStatusText">
                                    <span class="wa-status-dot disconnected" id="waDot"></span>
                                    <span>Mengecek status...</span>
                                </div>
                                <div class="wa-phone" id="waPhone" style="display: none;"></div>
                            </div>
                            <div class="wa-actions">
                                <button id="btnGenerateQR" class="btn btn-primary" onclick="generateQR()" style="display: none;">
                                    Generate QR Code
                                </button>
                                <button id="btnLogout" class="btn btn-secondary" onclick="logoutWA()" style="display: none;">
                                    Logout
                                </button>
                            </div>
                        </div>
                        <div id="qrSection" class="qr-section" style="display: none;">
                            <img id="qrImage" class="qr-image" src="" alt="QR Code">
                            <div class="qr-timer" id="qrTimer">02:00</div>
                            <p class="qr-hint">Scan dengan WhatsApp di HP Anda</p>
                        </div>
                    </div>
                </div>

                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon green">üí∞</div>
                            <span class="stat-badge active">Live</span>
                        </div>
                        <div class="stat-label">Total Piutang Aktif</div>
                        <div class="stat-value" id="statPiutang">Rp 0</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon green">üë•</div>
                            <span class="stat-badge active">Active</span>
                        </div>
                        <div class="stat-label">Total Borrowers</div>
                        <div class="stat-value" id="statBorrowers">0</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon green">üìã</div>
                            <span class="stat-badge active">Active</span>
                        </div>
                        <div class="stat-label">Perjanjian Aktif</div>
                        <div class="stat-value" id="statAgreements">0</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon green">üìÖ</div>
                            <span class="stat-badge pending">Pending</span>
                        </div>
                        <div class="stat-label">Cicilan Pending</div>
                        <div class="stat-value" id="statInstallments">0</div>
                    </div>
                </div>

                <!-- Recent Agreements -->
                <div class="card">
                    <div class="card-header">
                        <div style="display: flex; align-items: center; gap: 12px;">
                            <span style="font-size: 1.25rem;">üìã</span>
                            <span class="card-title">Perjanjian Terbaru</span>
                        </div>
                        <button class="btn btn-secondary" onclick="showPage('agreements')">Lihat Semua ‚Üí</button>
                    </div>
                    <div class="card-body">
                        <div class="table-container">
                            <table id="recentAgreements">
                                <thead>
                                    <tr>
                                        <th>Borrower</th>
                                        <th>Lender</th>
                                        <th>Total</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td colspan="4" class="empty-state">
                                        <div class="empty-state-icon">üì≠</div>
                                        <div>Memuat data...</div>
                                    </td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other Pages -->
            <div id="page-borrowers" class="page">
                <header class="header">
                    <div class="header-title">
                        <h2>Daftar Borrowers</h2>
                        <p>Peminjam yang terdaftar</p>
                    </div>
                    <button class="btn btn-secondary" onclick="loadBorrowers()">üîÑ Refresh</button>
                </header>
                <div class="card">
                    <div class="card-body">
                        <div class="table-container">
                            <table id="borrowersTable">
                                <thead>
                                    <tr><th>Nama</th><th>Nomor WA</th><th>Total Pinjaman</th><th>Action</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-lenders" class="page">
                <header class="header">
                    <div class="header-title">
                        <h2>Daftar Lenders</h2>
                        <p>Pemberi pinjaman</p>
                    </div>
                    <button class="btn btn-secondary" onclick="loadLenders()">üîÑ Refresh</button>
                </header>
                <div class="card">
                    <div class="card-body">
                        <div class="table-container">
                            <table id="lendersTable">
                                <thead>
                                    <tr><th>Nama</th><th>Nomor WA</th><th>Jumlah Perjanjian</th><th>Total Nilai</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-agreements" class="page">
                <header class="header">
                    <div class="header-title">
                        <h2>Daftar Perjanjian</h2>
                        <p>Semua perjanjian pinjaman</p>
                    </div>
                    <button class="btn btn-secondary" onclick="loadAgreements()">üîÑ Refresh</button>
                </header>
                <div class="card">
                    <div class="card-body">
                        <div class="table-container">
                            <table id="agreementsTable">
                                <thead>
                                    <tr><th>ID</th><th>Borrower</th><th>Total</th><th>Cicilan</th><th>Status</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-installments" class="page">
                <header class="header">
                    <div class="header-title">
                        <h2>Daftar Cicilan</h2>
                        <p>Jadwal pembayaran cicilan</p>
                    </div>
                    <button class="btn btn-secondary" onclick="loadInstallments()">üîÑ Refresh</button>
                </header>
                <div class="card">
                    <div class="card-body">
                        <div class="table-container">
                            <table id="installmentsTable">
                                <thead>
                                    <tr><th>ID</th><th>Borrower</th><th>Cicilan Ke</th><th>Jumlah</th><th>Jatuh Tempo</th><th>Status</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-system" class="page">
                <header class="header">
                    <div class="header-title">
                        <h2>System Resources</h2>
                        <p>Penggunaan resource server</p>
                    </div>
                    <button class="btn btn-secondary" onclick="loadSystemResources()">üîÑ Refresh</button>
                </header>
                <div id="systemContent">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-header"><div class="stat-icon green">üñ•Ô∏è</div></div>
                            <div class="stat-label">System Memory</div>
                            <div class="stat-value" id="sysMemPercent">-</div>
                            <div class="progress-bar"><div class="progress-fill" id="sysMemBar" style="width: 0%"></div></div>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-top: 8px;" id="sysMemText">-</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header"><div class="stat-icon green">üì±</div></div>
                            <div class="stat-label">BukuHutang Memory</div>
                            <div class="stat-value" id="appMemValue">-</div>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-top: 8px;">RSS Usage</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header"><div class="stat-icon green">‚ö°</div></div>
                            <div class="stat-label">System CPU</div>
                            <div class="stat-value" id="sysCpuPercent">-</div>
                            <div class="progress-bar"><div class="progress-fill" id="sysCpuBar" style="width: 0%"></div></div>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-top: 8px;" id="sysCpuText">-</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header"><div class="stat-icon green">üìä</div></div>
                            <div class="stat-label">BukuHutang CPU</div>
                            <div class="stat-value" id="appCpuPercent">-</div>
                            <div class="progress-bar"><div class="progress-fill" id="appCpuBar" style="width: 0%"></div></div>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-top: 8px;">Process Usage</p>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header"><div class="stat-icon green">‚è±Ô∏è</div></div>
                            <div class="stat-label">Uptime</div>
                            <div class="stat-value" id="uptimeValue">-</div>
                            <p style="color: var(--text-secondary); font-size: 0.85em; margin-top: 8px;">BukuHutang Running</p>
                        </div>
                    </div>
                    
                    <!-- Agent Status Section -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.25rem;">ü§ñ</span>
                                <span class="card-title">OpenClaw Agent Status</span>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="agentStatusContent">
                                <div style="display: flex; align-items: center; gap: 12px; padding: 20px;">
                                    <div class="pulse" style="color: var(--success);">‚è≥ Memuat status agent...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cron Jobs Section -->
                    <div class="card" style="margin-top: 24px;">
                        <div class="card-header">
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span style="font-size: 1.25rem;">‚è∞</span>
                                <span class="card-title">Cron Jobs (OpenClaw)</span>
                                <button class="btn btn-secondary" 
                                    onclick="showModal('Cron Jobs adalah tugas yang dijalankan secara otomatis pada jadwal tertentu. BukuHutang menggunakan OpenClaw untuk menjalankan 3 cron job: reminder cicilan, update status overdue, dan laporan harian.', 'Apa itu Cron Jobs?', 'info')"
                                    style="padding: 4px 8px; font-size: 0.8rem;"
                                >‚ÑπÔ∏è Info</button>
                            </div>
                            <button class="btn btn-secondary" onclick="loadAgentStatus()">üîÑ Refresh</button>
                        </div>
                        <div class="card-body">
                            <div id="cronJobsContent">
                                <div style="display: flex; align-items: center; gap: 12px; padding: 20px;">
                                    <div class="pulse" style="color: var(--success);">‚è≥ Memuat cron jobs...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Format helpers
        function formatRupiah(angka) {
            if (!angka) return 'Rp 0';
            return 'Rp ' + parseInt(angka).toLocaleString('id-ID');
        }

        function formatUptime(seconds) {
            const days = Math.floor(seconds / 86400);
            const hours = Math.floor((seconds % 86400) / 3600);
            const mins = Math.floor((seconds % 3600) / 60);
            if (days > 0) return `${days}d ${hours}h ${mins}m`;
            if (hours > 0) return `${hours}h ${mins}m`;
            return `${mins}m`;
        }

        // Navigation
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById(`page-${pageName}`).classList.add('active');
            
            const navItems = document.querySelectorAll('.nav-item');
            const pageMap = ['overview', 'borrowers', 'lenders', 'agreements', 'installments', 'system'];
            const index = pageMap.indexOf(pageName);
            if (index >= 0) navItems[index].classList.add('active');
            
            // Auto-load data for each page
            switch(pageName) {
                case 'overview':
                    loadStats();
                    break;
                case 'borrowers':
                    loadBorrowers();
                    break;
                case 'lenders':
                    loadLenders();
                    break;
                case 'agreements':
                    loadAgreements();
                    break;
                case 'installments':
                    loadInstallments();
                    break;
                case 'system':
                    loadSystemResources();
                    loadAgentStatus();
                    break;
            }
        }

        // Modal
        function showModal(message, title = 'Pemberitahuan', type = 'info') {
            const icons = { info: 'üì¢', success: '‚úÖ', error: '‚ùå', warning: '‚ö†Ô∏è' };
            document.getElementById('modalTitle').textContent = `${icons[type] || 'üì¢'} ${title}`;
            document.getElementById('modalMessage').textContent = message;
            document.getElementById('modalActions').innerHTML = 
                `<button class="btn btn-primary" onclick="closeModal()">OK</button>`;
            document.getElementById('modal').classList.add('active');
        }

        function showConfirm(message, onConfirm, title = 'Konfirmasi') {
            document.getElementById('modalTitle').textContent = `‚ùì ${title}`;
            document.getElementById('modalMessage').textContent = message;
            window._confirmCallback = onConfirm;
            document.getElementById('modalActions').innerHTML = `
                <button class="btn btn-secondary" onclick="closeModal()">Batal</button>
                <button class="btn btn-primary" onclick="closeModal(); window._confirmCallback?.();">Ya</button>
            `;
            document.getElementById('modal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }

        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) closeModal();
        });

        // WhatsApp
        let qrTimer, countdownInterval;

        async function checkWAStatus() {
            try {
                const res = await fetch('/api/public/whatsapp/status');
                const data = await res.json();
                updateWAUI(data);
            } catch (e) {
                console.error('WA check error:', e);
            }
        }

        function updateWAUI(data) {
            const dot = document.getElementById('waDot');
            const text = document.querySelector('#waStatusMain span:last-child') || document.querySelector('#waStatusText span:last-child');
            const phone = document.getElementById('waPhone');
            const badge = document.getElementById('waBadge');
            const btnGen = document.getElementById('btnGenerateQR');
            const btnLogout = document.getElementById('btnLogout');
            const qrSection = document.getElementById('qrSection');

            if (data.connected) {
                dot.className = 'wa-status-dot connected';
                text.textContent = 'Connected';
                phone.textContent = data.phoneNumber || '';
                phone.style.display = 'block';
                badge.textContent = 'Connected';
                badge.className = 'stat-badge active';
                btnGen.style.display = 'none';
                btnLogout.style.display = 'inline-flex';
                qrSection.style.display = 'none';
                stopQR();
            } else {
                dot.className = 'wa-status-dot disconnected';
                text.textContent = 'Disconnected';
                phone.style.display = 'none';
                badge.textContent = 'Disconnected';
                badge.className = 'stat-badge pending';
                btnGen.style.display = 'inline-flex';
                btnLogout.style.display = 'none';
            }
        }

        async function generateQR() {
            const btn = document.getElementById('btnGenerateQR');
            btn.disabled = true;
            btn.textContent = 'Generating...';

            try {
                const res = await fetch('/api/public/whatsapp/status');
                const data = await res.json();

                if (data.connected) {
                    updateWAUI(data);
                    return;
                }

                if (data.qrCode) {
                    document.getElementById('qrImage').src = data.qrCode;
                    document.getElementById('qrSection').style.display = 'block';
                    startQRCountdown(120);
                    
                    // Show success popup
                    showModal('QR Code berhasil dibuat!\n\nScan dengan WhatsApp di HP Anda dalam waktu 2 menit.', 'QR Generated', 'success');
                    
                    qrTimer = setTimeout(() => {
                        document.getElementById('qrSection').style.display = 'none';
                        showModal('QR Code expired. Silakan generate ulang.', 'QR Expired', 'warning');
                    }, 120000);
                } else {
                    // QR not ready yet
                    showModal('QR Code belum siap. Tunggu beberapa detik dan coba lagi.', 'QR Not Ready', 'warning');
                }
            } catch (e) {
                showModal('Gagal generate QR code', 'Error', 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Generate QR Code';
            }
        }

        function startQRCountdown(seconds) {
            let remaining = seconds;
            const timerEl = document.getElementById('qrTimer');
            stopQR();
            
            countdownInterval = setInterval(() => {
                remaining--;
                const mins = Math.floor(remaining / 60);
                const secs = remaining % 60;
                timerEl.textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                
                if (remaining <= 0) {
                    stopQR();
                    document.getElementById('qrSection').style.display = 'none';
                    showModal('Waktu scan habis! QR Code expired. Silakan generate ulang.', 'QR Expired', 'warning');
                }
            }, 1000);
        }

        function stopQR() {
            if (countdownInterval) clearInterval(countdownInterval);
            if (qrTimer) clearTimeout(qrTimer);
        }

        function logoutWA() {
            showConfirm('Yakin logout dari WhatsApp?', async () => {
                try {
                    await fetch('/api/public/whatsapp/logout', { method: 'POST' });
                    showModal('WhatsApp logged out', 'Logout Berhasil', 'success');
                    checkWAStatus();
                } catch (e) {
                    showModal('Gagal logout', 'Error', 'error');
                }
            });
        }

        // Data loading
        async function loadStats() {
            try {
                const [agreementsRes, installmentsRes] = await Promise.all([
                    fetch('/api/public/agreements'),
                    fetch('/api/public/installments')
                ]);
                
                const agreements = await agreementsRes.json();
                const installments = await installmentsRes.json();
                
                const totalPiutang = agreements.agreements?.reduce((s, a) => s + (a.total_amount || 0), 0) || 0;
                const borrowers = new Set(agreements.agreements?.map(a => a.borrower_phone)).size;
                const pendingInstallments = installments.installments?.filter(i => i.status === 'pending').length || 0;

                document.getElementById('statPiutang').textContent = formatRupiah(totalPiutang);
                document.getElementById('statBorrowers').textContent = borrowers;
                document.getElementById('statAgreements').textContent = agreements.agreements?.length || 0;
                document.getElementById('statInstallments').textContent = pendingInstallments;

                // Recent agreements table
                const tbody = document.querySelector('#recentAgreements tbody');
                if (agreements.agreements?.length) {
                    tbody.innerHTML = agreements.agreements.slice(0, 5).map(a => `
                        <tr>
                            <td><strong>${a.borrower_name}</strong></td>
                            <td>${a.actual_lender_name || '-'}</td>
                            <td>${formatRupiah(a.total_amount)}</td>
                            <td><span class="status ${a.status}">${a.status}</span></td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = `
                        <tr><td colspan="4" class="empty-state">
                            <div class="empty-state-icon">üì≠</div>
                            <div>Belum ada perjanjian</div>
                        </td></tr>`;
                }
            } catch (e) {
                console.error('Load stats error:', e);
            }
        }

        function refreshAll() {
            checkWAStatus();
            loadStats();
        }

        // Load Borrowers
        async function loadBorrowers() {
            const tbody = document.querySelector('#borrowersTable tbody');
            tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 40px;"><div class="pulse" style="color: var(--success);">‚è≥ Memuat data...</div></td></tr>';
            
            try {
                const res = await fetch('/api/public/agreements');
                const data = await res.json();
                
                const borrowers = {};
                data.agreements?.forEach(a => {
                    if (!borrowers[a.borrower_phone]) {
                        borrowers[a.borrower_phone] = {
                            name: a.borrower_name,
                            phone: a.borrower_phone,
                            total: 0
                        };
                    }
                    borrowers[a.borrower_phone].total += a.total_amount;
                });

                const list = Object.values(borrowers);
                if (list.length) {
                    tbody.innerHTML = list.map(b => `
                        <tr>
                            <td><strong>${b.name}</strong></td>
                            <td>${b.phone}</td>
                            <td>${formatRupiah(b.total)}</td>
                            <td><button class="btn btn-secondary" onclick="showModal('Reminder untuk ${b.name} akan dikirim')">üì± Reminder</button></td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" class="empty-state"><div class="empty-state-icon">üë§</div>Tidak ada borrowers</td></tr>';
                }
            } catch (e) {
                console.error('Load borrowers error:', e);
            }
        }

        // Load Lenders
        async function loadLenders() {
            const tbody = document.querySelector('#lendersTable tbody');
            tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 40px;"><div class="pulse" style="color: var(--success);">‚è≥ Memuat data...</div></td></tr>';
            
            try {
                const res = await fetch('/api/public/agreements');
                const data = await res.json();
                
                const lenders = {};
                data.agreements?.forEach(a => {
                    const key = a.actual_lender_phone || 'unknown';
                    if (!lenders[key]) {
                        lenders[key] = {
                            name: a.actual_lender_name || 'Unknown',
                            phone: a.actual_lender_phone || '-',
                            total: 0,
                            count: 0
                        };
                    }
                    lenders[key].total += a.total_amount;
                    lenders[key].count++;
                });

                const list = Object.values(lenders);
                if (list.length) {
                    tbody.innerHTML = list.map(l => `
                        <tr>
                            <td><strong>${l.name}</strong></td>
                            <td>${l.phone}</td>
                            <td>${l.count} perjanjian</td>
                            <td>${formatRupiah(l.total)}</td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="4" class="empty-state"><div class="empty-state-icon">üíº</div>Tidak ada lenders</td></tr>';
                }
            } catch (e) {
                console.error('Load lenders error:', e);
            }
        }

        // Load Agreements
        async function loadAgreements() {
            const tbody = document.querySelector('#agreementsTable tbody');
            tbody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 40px;"><div class="pulse" style="color: var(--success);">‚è≥ Memuat data...</div></td></tr>';
            
            try {
                const res = await fetch('/api/public/agreements');
                const data = await res.json();
                
                if (data.agreements?.length) {
                    tbody.innerHTML = data.agreements.map(a => `
                        <tr>
                            <td>#${a.id}</td>
                            <td><strong>${a.borrower_name}</strong></td>
                            <td>${formatRupiah(a.total_amount)}</td>
                            <td>${a.installment_count}x ${formatRupiah(a.installment_amount)}</td>
                            <td><span class="status ${a.status}">${a.status}</span></td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="5" class="empty-state"><div class="empty-state-icon">üìã</div>Tidak ada perjanjian</td></tr>';
                }
            } catch (e) {
                console.error('Load agreements error:', e);
            }
        }

        // Load Installments
        async function loadInstallments() {
            const tbody = document.querySelector('#installmentsTable tbody');
            tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px;"><div class="pulse" style="color: var(--success);">‚è≥ Memuat data...</div></td></tr>';
            
            try {
                const res = await fetch('/api/public/installments');
                const data = await res.json();
                
                if (data.installments?.length) {
                    tbody.innerHTML = data.installments.map(i => `
                        <tr>
                            <td>#${i.id}</td>
                            <td><strong>${i.borrower_name}</strong></td>
                            <td>Cicilan #${i.installment_number}</td>
                            <td>${formatRupiah(i.amount)}</td>
                            <td>${new Date(i.due_date).toLocaleDateString('id-ID')}</td>
                            <td><span class="status ${i.status}">${i.status}</span></td>
                        </tr>
                    `).join('');
                } else {
                    tbody.innerHTML = '<tr><td colspan="6" class="empty-state"><div class="empty-state-icon">üìÖ</div>Tidak ada cicilan</td></tr>';
                }
            } catch (e) {
                console.error('Load installments error:', e);
            }
        }

        // Load System Resources
        async function loadSystemResources() {
            document.getElementById('sysMemPercent').textContent = '‚è≥';
            document.getElementById('appMemValue').textContent = '‚è≥';
            document.getElementById('sysCpuPercent').textContent = '‚è≥';
            document.getElementById('appCpuPercent').textContent = '‚è≥';
            document.getElementById('uptimeValue').textContent = '‚è≥';
            
            try {
                const res = await fetch('/api/public/system-resources');
                const data = await res.json();
                const mem = data.memory;
                const cpu = data.cpu;

                // Memory
                document.getElementById('sysMemPercent').textContent = mem.usagePercent + '%';
                document.getElementById('sysMemText').textContent = `${mem.used} MB / ${mem.total} MB`;
                const memBar = document.getElementById('sysMemBar');
                memBar.style.width = mem.usagePercent + '%';
                memBar.className = 'progress-fill ' + (mem.usagePercent > 80 ? 'red' : mem.usagePercent > 60 ? 'yellow' : 'green');

                // App Memory
                document.getElementById('appMemValue').textContent = mem.process.rss + ' MB';

                // CPU
                document.getElementById('sysCpuPercent').textContent = cpu.usagePercent + '%';
                document.getElementById('sysCpuText').textContent = `${cpu.count} cores`;
                const cpuBar = document.getElementById('sysCpuBar');
                cpuBar.style.width = Math.min(cpu.usagePercent, 100) + '%';
                cpuBar.className = 'progress-fill ' + (cpu.usagePercent > 80 ? 'red' : cpu.usagePercent > 60 ? 'yellow' : 'green');

                // App CPU
                const appCpu = cpu.process?.usagePercent || 0;
                document.getElementById('appCpuPercent').textContent = appCpu + '%';
                const appCpuBar = document.getElementById('appCpuBar');
                appCpuBar.style.width = Math.min(appCpu, 100) + '%';
                appCpuBar.className = 'progress-fill ' + (appCpu > 50 ? 'red' : appCpu > 30 ? 'yellow' : 'green');

                // Uptime
                const formatUptime = (seconds) => {
                    const days = Math.floor(seconds / 86400);
                    const hours = Math.floor((seconds % 86400) / 3600);
                    const mins = Math.floor((seconds % 3600) / 60);
                    if (days > 0) return `${days}d ${hours}h ${mins}m`;
                    if (hours > 0) return `${hours}h ${mins}m`;
                    return `${mins}m`;
                };
                document.getElementById('uptimeValue').textContent = formatUptime(data.uptime.process);
                
                // Also load agent status
                loadAgentStatus();
            } catch (e) {
                console.error('Load system resources error:', e);
            }
        }

        // Load Agent Status & Cron Jobs
        async function loadAgentStatus() {
            const agentContent = document.getElementById('agentStatusContent');
            const cronContent = document.getElementById('cronJobsContent');
            
            try {
                // This would typically come from an API endpoint
                // For now, we'll display static info based on known configuration
                const agentStatus = {
                    name: 'BukuHutang Worker',
                    status: 'active',
                    lastRun: '2 menit yang lalu',
                    nextRun: 'dalam 4 jam',
                    openclawVersion: 'v2.x'
                };
                
                const cronJobs = [
                    { 
                        name: 'bukuhutang-reminders-v2', 
                        schedule: 'Setiap 6 jam', 
                        status: 'active', 
                        lastRun: '2 jam yang lalu',
                        description: 'Mengirim reminder WhatsApp ke borrower yang memiliki cicilan jatuh tempo dalam 3 hari. Memeriksa database setiap 6 jam.'
                    },
                    { 
                        name: 'bukuhutang-installments-v2', 
                        schedule: 'Setiap 6 jam', 
                        status: 'active', 
                        lastRun: '2 jam yang lalu',
                        description: 'Memperbarui status cicilan yang sudah lewat jatuh tempo dari "pending" menjadi "overdue". Berjalan bersamaan dengan reminder.'
                    },
                    { 
                        name: 'bukuhutang-daily-report', 
                        schedule: 'Setiap hari 08:00', 
                        status: 'active', 
                        lastRun: 'Kemarin',
                        description: 'Mengirim laporan harian ke admin via WhatsApp berisi ringkasan: total piutang, cicilan overdue, dan statistik harian.'
                    }
                ];
                
                // Render Agent Status
                agentContent.innerHTML = `
                    <div style="display: flex; justify-content: flex-end; margin-bottom: 12px;">
                        <button class="info-btn" onclick="showModal('OpenClaw Agent adalah worker AI yang berjalan di background untuk mengotomasi pengiriman reminder WhatsApp, update status cicilan, dan laporan harian. Agent ini dijalankan oleh OpenClaw Cron setiap beberapa jam.', 'Apa itu OpenClaw Agent?', 'info')" title="Info"
                            style="background: transparent; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1rem; padding: 8px; border-radius: 8px; transition: all 0.2s ease;"
                            onmouseover="this.style.color='var(--success)'" onmouseout="this.style.color='var(--text-secondary)'"
                        >‚ÑπÔ∏è Apa ini?</button>
                    </div>
                    <div class="stats-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon green">ü§ñ</div>
                                <span class="stat-badge active">${agentStatus.status.toUpperCase()}</span>
                            </div>
                            <div class="stat-label">${agentStatus.name}</div>
                            <div class="stat-value" style="font-size: 1rem;">${agentStatus.openclawVersion}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon green">üîÑ</div>
                            </div>
                            <div class="stat-label">Last Run</div>
                            <div class="stat-value" style="font-size: 1rem;">${agentStatus.lastRun}</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-icon green">‚è≠Ô∏è</div>
                            </div>
                            <div class="stat-label">Next Run</div>
                            <div class="stat-value" style="font-size: 1rem;">${agentStatus.nextRun}</div>
                        </div>
                    </div>
                `;
                
                // Render Cron Jobs
                cronContent.innerHTML = `
                    <style>
                        .info-btn {
                            background: transparent;
                            border: none;
                            color: var(--text-secondary);
                            cursor: pointer;
                            font-size: 1rem;
                            padding: 4px;
                            margin-left: 8px;
                            border-radius: 4px;
                            transition: all 0.2s ease;
                        }
                        .info-btn:hover {
                            color: var(--success);
                            background: rgba(34, 197, 94, 0.1);
                        }
                    </style>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Nama Job</th>
                                    <th>Jadwal</th>
                                    <th>Status</th>
                                    <th>Last Run</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${cronJobs.map(job => `
                                    <tr>
                                        <td>
                                            <strong>${job.name}</strong>
                                            <button class="info-btn" onclick="showModal('${job.description.replace(/'/g, "\\'")}', '${job.name}', 'info')" title="Info">‚ÑπÔ∏è</button>
                                        </td>
                                        <td>${job.schedule}</td>
                                        <td><span class="status ${job.status}">${job.status.toUpperCase()}</span></td>
                                        <td>${job.lastRun}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
            } catch (e) {
                console.error('Load agent status error:', e);
                agentContent.innerHTML = '<div style="padding: 20px; color: var(--danger);">‚ùå Gagal memuat agent status</div>';
                cronContent.innerHTML = '<div style="padding: 20px; color: var(--danger);">‚ùå Gagal memuat cron jobs</div>';
            }
        }

        // Init
        window.addEventListener('DOMContentLoaded', () => {
            checkWAStatus();
            loadStats();
        });
    </script>
</body>
</html>